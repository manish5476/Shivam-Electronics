<p-toast></p-toast>
<p-confirmDialog [style]="{ width: '30vw' }"></p-confirmDialog>

<div class="card p-6">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-2xl font-bold">Master List Types</h2>
    <button
      pButton
      label="Add Type"
      icon="pi pi-plus"
      class="p-button-success"
      (click)="openNew()"
    ></button>
  </div>

  <p-table
    [value]="types"
    [paginator]="true"
    [rows]="10"
    styleClass="p-datatable-sm modern-grid"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Display Name</th>
        <th>System Key (Type)</th>
        <th>Description</th>
        <th style="width: 8rem" class="text-center">Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-type>
      <tr>
        <td>{{ type.name }}</td>
        <td>
          <span class="p-1 bg-gray-200 rounded text-xs font-mono">{{
            type.type
          }}</span>
        </td>
        <td>{{ type.description }}</td>
        <td class="text-center">
          <button
            pButton
            icon="pi pi-trash"
            class="p-button-rounded p-button-text p-button-danger"
            (click)="deleteType(type)"
          ></button>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="4" class="text-center p-4">
          No master list types found. Click "Add Type" to create one.
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<p-dialog
  [(visible)]="typeDialog"
  [modal]="true"
  [style]="{ width: '450px' }"
  header="Master List Type Details"
  (onHide)="hideDialog()"
>
  <div class="p-fluid flex flex-col gap-4 pt-4">
    <div>
      <label for="name">Display Name</label>
      <input
        id="name"
        pInputText
        [(ngModel)]="editingType.name"
        required
        autofocus
        [ngClass]="{ 'ng-invalid ng-dirty': submitted && !editingType.name }"
      />
      <small class="p-error" *ngIf="submitted && !editingType.name"
        >Name is required.</small
      >
    </div>
    <div>
      <label for="type">System Key (e.g., customerTypes)</label>
      <input
        id="type"
        pInputText
        [(ngModel)]="editingType.type"
        required
        [ngClass]="{ 'ng-invalid ng-dirty': submitted && !editingType.type }"
      />
      <small class="p-error" *ngIf="submitted && !editingType.type"
        >System Key is required.</small
      >
    </div>
    <div>
      <label for="description">Description</label>
      <textarea
        id="description"
        pInputTextarea
        [(ngModel)]="editingType.description"
        rows="3"
      ></textarea>
    </div>
  </div>
  <ng-template pTemplate="footer">
    <button
      pButton
      label="Cancel"
      icon="pi pi-times"
      class="p-button-text"
      (click)="hideDialog()"
    ></button>
    <button
      pButton
      label="Save"
      icon="pi pi-check"
      (click)="saveType()"
    ></button>
  </ng-template>
</p-dialog>
