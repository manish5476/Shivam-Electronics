<div class="customer-snapshot p-4 md:p-6 bg-white rounded-2xl shadow-md" *ngIf="customerData">
  <!-- Header -->
  <header class="customer-header flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-6 pb-4 border-b border-gray-200">
    <!-- Avatar + Info -->
    <div class="flex items-center gap-4">
      <div class="avatar-container w-16 h-16 md:w-20 md:h-20 rounded-full overflow-hidden shadow-md">
        <img *ngIf="customerData.customer.profileImg" [src]="customerData.customer.profileImg" alt="Profile" class="w-full h-full object-cover">
        <div *ngIf="!customerData.customer.profileImg" class="w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-400 to-indigo-500 text-white text-2xl md:text-3xl font-bold">
          {{ customerData.customer.fullname.charAt(0).toUpperCase() }}
        </div>
      </div>
      <div>
        <h1 class="text-xl md:text-2xl font-semibold text-gray-800">{{ customerData.customer.fullname | titlecase }}</h1>
        <div class="text-sm md:text-base text-gray-600 flex flex-col md:flex-row items-start md:items-center gap-2 md:gap-4 mt-1">
          <span class="flex items-center gap-1"><i class="pi pi-envelope text-blue-500"></i> {{ customerData.customer.email }}</span>
          <span class="flex items-center gap-1"><i class="pi pi-phone text-green-500"></i> {{ customerData.customer.mobileNumber }}</span>
        </div>
      </div>
    </div>

    <!-- Status Tag -->
    <p-tag [value]="customerData.customer.status" [severity]="getStatusSeverity(customerData.customer.status)" [rounded]="true" class="text-sm px-3 py-1"></p-tag>
  </header>

  <!-- Metrics -->
  <section class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
    <div class="metric-card p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-xl shadow-sm text-center transition-all duration-300 hover:shadow-md">
      <div class="flex justify-center mb-2">
        <i class="pi pi-dollar text-green-500 text-2xl bg-green-200 p-2 rounded-full"></i>
      </div>
      <div class="text-sm text-gray-600">Lifetime Value</div>
      <div class="text-xl md:text-2xl font-bold text-green-700">{{ customerData.lifetimeValue | currency:'INR':'symbol':'1.0-0' }}</div>
    </div>
    <div class="metric-card p-4 bg-gradient-to-br from-red-50 to-red-100 rounded-xl shadow-sm text-center transition-all duration-300 hover:shadow-md">
      <div class="flex justify-center mb-2">
        <i class="pi pi-exclamation-triangle text-red-500 text-2xl bg-red-200 p-2 rounded-full"></i>
      </div>
      <div class="text-sm text-gray-600">Overdue</div>
      <div class="text-xl md:text-2xl font-bold" [ngClass]="{'text-red-700': customerData.overdueInvoices.length > 0, 'text-gray-500': customerData.overdueInvoices.length === 0}">
        {{ customerData.overdueInvoices.length }}
      </div>
    </div>
    <div class="metric-card p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl shadow-sm text-center transition-all duration-300 hover:shadow-md">
      <div class="flex justify-center mb-2">
        <i class="pi pi-calendar text-blue-500 text-2xl bg-blue-200 p-2 rounded-full"></i>
      </div>
      <div class="text-sm text-gray-600">Member Since</div>
      <div class="text-xl md:text-2xl font-bold text-blue-700">{{ customerData.customer.createdAt | date: 'MMM yyyy' }}</div>
    </div>
  </section>

  <!-- Product Preferences -->
  <section class="mb-6">
    <h3 class="text-base md:text-lg font-semibold mb-3 flex items-center gap-2 text-gray-800">
      <i class="pi pi-tags text-purple-500"></i> Product Preferences
    </h3>
    <div class="flex flex-wrap gap-2">
      <p-tag *ngFor="let pref of customerData.productPreferences" [value]="pref.product + ' (x' + pref.quantity + ')'"
        severity="secondary" [rounded]="true" class="text-xs px-3 py-1 bg-purple-100 text-purple-700"></p-tag>
    </div>
  </section>

  <!-- Tabs -->
  <p-tabView>
    <p-tabPanel header="Activity">
      <div class="space-y-4">
        <div class="activity-card p-4 bg-white rounded-xl shadow-sm transition-all duration-300 hover:shadow-md" *ngFor="let invoice of customerData.recentActivity.invoices">
          <div class="flex justify-between items-center mb-2">
            <span class="font-semibold text-gray-800">Invoice #{{ invoice.invoiceNumber }}</span>
            <p-tag [value]="invoice.status" [severity]="getStatusSeverity(invoice.status)" [rounded]="true" class="text-xs"></p-tag>
          </div>
          <div class="grid grid-cols-2 gap-2 text-sm text-gray-600">
            <div>Date: {{ invoice.invoiceDate | date: 'shortDate' }}</div>
            <div>Due: {{ invoice.dueDate | date: 'shortDate' }}</div>
          </div>
          <div class="text-right mt-2 font-bold text-gray-900">{{ invoice.totalAmount | currency:'INR' }}</div>
        </div>
        <div *ngIf="!customerData.recentActivity.invoices.length" class="text-center py-8 text-gray-500">
          <i class="pi pi-info-circle text-4xl mb-2"></i>
          <p>No recent activity</p>
        </div>
      </div>
    </p-tabPanel>

    <p-tabPanel header="Overdue">
      <div class="space-y-4">
        <div class="overdue-card p-4 bg-red-50 rounded-xl shadow-sm transition-all duration-300 hover:shadow-md" *ngFor="let invoice of customerData.overdueInvoices">
          <div class="flex justify-between items-center mb-2">
            <span class="font-semibold text-red-800">Invoice #{{ invoice.invoiceNumber }}</span>
            <p-tag value="Overdue" severity="danger" [rounded]="true" class="text-xs"></p-tag>
          </div>
          <div class="text-sm text-red-700">
            Due: {{ invoice.dueDate | date: 'shortDate' }}
          </div>
          <div class="text-right mt-2 font-bold text-red-900">{{ invoice.totalAmount | currency:'INR' }}</div>
        </div>
        <div *ngIf="!customerData.overdueInvoices.length" class="text-center py-8 text-gray-500">
          <i class="pi pi-check-circle text-4xl mb-2 text-green-500"></i>
          <p>No overdue invoices</p>
        </div>
      </div>
    </p-tabPanel>

    <p-tabPanel header="Addresses">
      <div class="space-y-4">
        <div class="address-card p-4 bg-gray-50 rounded-xl shadow-sm transition-all duration-300 hover:shadow-md" *ngFor="let address of customerData.customer.addresses">
          <h3 class="text-sm font-semibold flex items-center gap-2 text-gray-800 mb-2">
            <i class="pi pi-map-marker text-orange-500"></i> {{ address.type | titlecase }}
          </h3>
          <p class="text-sm text-gray-600">
            {{ address.street }}<br>
            {{ address.city }}, {{ address.state }} - {{ address.zipCode }}<br>
            {{ address.country }}
          </p>
        </div>
        <div *ngIf="!customerData.customer.addresses.length" class="text-center py-8 text-gray-500">
          <i class="pi pi-map text-4xl mb-2"></i>
          <p>No addresses on file</p>
        </div>
      </div>
    </p-tabPanel>
  </p-tabView>
</div>